{% extends "core/base.html" %}
{% load static i18n %}
{% get_current_language as CURRENT_LANG %}

{% block title %}{{ page_title }}{% endblock %}
{% block meta_description %}{{ page_description }}{% endblock %}
{% block extra_meta %}
<script type="application/ld+json">
{{ structured_data|safe }}
</script>
{% endblock %}
{% block content %}
<article class="news-detail-page">
  <!-- –ì–µ—Ä–æ–π —Å–µ–∫—Ü—ñ—è -->
  <section class="news-hero">
    <div class="container">
      
      <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—è —Ç–∞ –º–µ—Ç–∞ —ñ–Ω—Ñ–æ -->
      <div class="article-meta">
        <span class="category-badge">
          {{ article.category.icon }} 
          <span data-lang="en">{{ article.category.name_en }}</span>
          <span data-lang="uk">{{ article.category.name_uk }}</span>
          <span data-lang="pl">{{ article.category.name_pl }}</span>
        </span>
        
        {% if article.is_top_article %}
          <span class="top-article-badge">üëë TOP</span>
        {% endif %}
        
        {% if article.priority >= 3 %}
          <span class="priority-badge">üî• HOT</span>
        {% endif %}
      </div>

      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <h2>
        <span data-lang="en">{{ article.title_en|safe }}</span>
        <span data-lang="uk">{{ article.title_uk|safe }}</span>
        <span data-lang="pl">{{ article.title_pl|safe }}</span>
      </h2>

      <!-- –ú–µ—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
      <div class="article-info">
        <time datetime="{{ article.published_at|date:'c' }}" class="publish-date">
          üìÖ {{ article.published_at|date:'j F Y' }}
        </time>
        <span class="reading-time">‚è±Ô∏è {{ article.get_reading_time }} —Ö–≤ —á–∏—Ç–∞–Ω–Ω—è</span>
        <span class="views-count">üëÅÔ∏è {{ article.get_total_views }} –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤</span>
        {% if article.original_source_url and article.original_source_name %}
          <span class="source-info">
            üîó <a href="{{ article.original_source_url }}" target="_blank" rel="nofollow noopener">{{ article.original_source_name }}</a>
          </span>
        {% endif %}
      </div>
    </div>
  </section>

  <!-- AI –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è -->
  {% if article.ai_image_url %}
    <section class="article-image">
      <div class="container">
        <div class="image-container glass">
          <img src="{{ article.ai_image_url }}" 
               alt="{% if CURRENT_LANG == 'uk' and article.title_uk %}{{ article.title_uk|safe }}{% elif CURRENT_LANG == 'pl' and article.title_pl %}{{ article.title_pl|safe }}{% else %}{{ article.title_en|safe }}{% endif %}" 
               loading="lazy"
               style="width: 100%; height: auto; object-fit: contain; border-radius: var(--radius-xl);">
        </div>
      </div>
    </section>
  {% endif %}

  <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <section class="article-content">
    <div class="container">
      <div class="content-layout">
        
        <!-- –û—Å–Ω–æ–≤–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="main-content">
          
          <!-- –ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å -->
          <div class="article-summary glass">
            <div class="summary-icon">üí°</div>
            <div class="summary-content">
              <div data-lang="en">{{ article.summary_en|safe }}</div>
              <div data-lang="uk">{{ article.summary_uk|safe }}</div>
              <div data-lang="pl">{{ article.summary_pl|safe }}</div>
            </div>
          </div>

          <!-- –ë—ñ–∑–Ω–µ—Å —ñ–Ω—Å–∞–π—Ç -->
          <div class="business-insight card card-lg" style="margin-top: 2rem; margin-bottom: 2rem;">
            <div class="card-header">
              <div class="card-icon">üéØ</div>
              <h2>
                <span data-lang="en">Business Impact</span>
                <span data-lang="uk">–í–ø–ª–∏–≤ –Ω–∞ –±—ñ–∑–Ω–µ—Å</span>
                <span data-lang="pl">Wp≈Çyw na biznes</span>
              </h2>
            </div>
            <div class="card-content">
              <div data-lang="en">{{ article.business_insight_en|safe }}</div>
              <div data-lang="uk">{{ article.business_insight_uk|safe }}</div>
              <div data-lang="pl">{{ article.business_insight_pl|safe }}</div>
            </div>
          </div>

          <!-- –¶—ñ–∫–∞–≤–∏–Ω–∫–∏ (—è–∫—â–æ —î) -->
          {% if article.get_interesting_facts %}
            <div class="interesting-facts glass">
              <h2>
                <span class="heading-icon">‚ú®</span>
                <span data-lang="en">Interesting Facts</span>
                <span data-lang="uk">–¶—ñ–∫–∞–≤–∏–Ω–∫–∏</span>
                <span data-lang="pl">InteresujƒÖce fakty</span>
              </h2>
              <ul class="facts-list">
                {% for fact in article.get_interesting_facts %}
                  <li class="fact-item">{{ fact }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          <!-- –ë—ñ–∑–Ω–µ—Å –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ (—è–∫—â–æ —î) -->
          {% if article.business_opportunities_en or article.business_opportunities_uk or article.business_opportunities_pl %}
            <div class="business-opportunities card card-lg" style="margin-top: 2rem; margin-bottom: 2rem;">
              <div class="card-header">
                <div class="card-icon">üöÄ</div>
                <h2 class="card-title">
                  <span data-lang="en">Business Opportunities</span>
                  <span data-lang="uk">–ë—ñ–∑–Ω–µ—Å –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ</span>
                  <span data-lang="pl">Mo≈ºliwo≈õci biznesowe</span>
                </h2>
              </div>
              <div class="card-content">
                <div class="opportunities-content">
                  <div data-lang="en">{{ article.business_opportunities_en|safe }}</div>
                  <div data-lang="uk">{{ article.business_opportunities_uk|safe }}</div>
                  <div data-lang="pl">{{ article.business_opportunities_pl|safe }}</div>
                </div>
              </div>
            </div>
          {% endif %}

          <!-- LAZYSOFT —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó -->
          {% if article.lazysoft_recommendations_en or article.lazysoft_recommendations_uk or article.lazysoft_recommendations_pl %}
            <div class="lazysoft-recommendations card card-lg" style="margin-top: 2rem; margin-bottom: 2rem;">
              <div class="card-header">
                <div class="card-icon">üéØ</div>
                <h2 class="card-title">
                  <span data-lang="en">LAZYSOFT Recommendations</span>
                  <span data-lang="uk">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó LAZYSOFT</span>
                  <span data-lang="pl">Rekomendacje LAZYSOFT</span>
                </h2>
              </div>
              <div class="card-content">
                <div class="recommendations-content">
                  <div data-lang="en">{{ article.lazysoft_recommendations_en|safe }}</div>
                  <div data-lang="uk">{{ article.lazysoft_recommendations_uk|safe }}</div>
                  <div data-lang="pl">{{ article.lazysoft_recommendations_pl|safe }}</div>
                </div>
              </div>
            </div>
          {% endif %}
        </div>

        <!-- –°–∞–π–¥–±–∞—Ä -->
        <aside class="article-sidebar">
          

          <!-- CTA –±–ª–æ–∫ -->
          <div class="sidebar-block cta-block glass">
            <h3>
              <span data-lang="en">Need Automation?</span>
              <span data-lang="uk">–ü–æ—Ç—Ä—ñ–±–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è?</span>
              <span data-lang="pl">Potrzebujesz automatyzacji?</span>
            </h3>
            <p>
              <span data-lang="en">Let's discuss how this technology can transform your business</span>
              <span data-lang="uk">–û–±–≥–æ–≤–æ—Ä–∏–º–æ, —è–∫ —Ü—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è –º–æ–∂–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –≤–∞—à –±—ñ–∑–Ω–µ—Å</span>
              <span data-lang="pl">Om√≥wmy, jak ta technologia mo≈ºe przekszta≈Çciƒá Tw√≥j biznes</span>
            </p>
            <button class="cta-button" onclick="scrollToContact('{{ article.get_title }}');">
              <span class="button-icon">üí¨</span>
              <span data-lang="en">Let's Talk</span>
              <span data-lang="uk">–ü–æ–≥–æ–≤–æ—Ä–∏–º–æ</span>
              <span data-lang="pl">Porozmawiajmy</span>
            </button>
          </div>

          <!-- –°—Ö–æ–∂—ñ —Å—Ç–∞—Ç—Ç—ñ -->
          {% if related_articles %}
            <div class="sidebar-block related-articles glass">
              <h3>
                <span data-lang="en">Related News</span>
                <span data-lang="uk">–°—Ö–æ–∂—ñ –Ω–æ–≤–∏–Ω–∏</span>
                <span data-lang="pl">Podobne wiadomo≈õci</span>
              </h3>
              <div class="related-list">
                {% for related in related_articles %}
                  <a href="{{ related.get_absolute_url }}" class="related-item">
                    <p>{{ related.get_title|truncatewords:10 }}</p
                    <p>
                      {{ related.category.icon }} {{ related.published_at|date:'j.m' }}
                    </p>
                  </a>
                {% endfor %}
              </div>
            </div>
          {% endif %}

          {% if related_projects %}
            <section class="related-projects">
              <h3>{% trans "–ü–æ–≤'—è–∑–∞–Ω—ñ –ø—Ä–æ—î–∫—Ç–∏" %}</h3>
              <div class="cards-grid">
                {% for p in related_projects %}
                  <a href="/{{ CURRENT_LANG }}/projects/{{ p.slug }}/" class="project-card glass">
                    {% if p.featured_image %}
                      <img src="{{ p.featured_image }}" alt="{{ p.title }}">
                    {% endif %}
                    <h3>{{ p.title }}</h3>
                    <p>{{ p.short_description }}</p>
                  </a>
                {% endfor %}
              </div>
            </section>
          {% endif %}

          {% if related_services %}
            <section class="related-services">
              <h3>{% trans "–ü–æ–≤'—è–∑–∞–Ω—ñ –ø–æ—Å–ª—É–≥–∏" %}</h3>
              <div class="cards-grid">
                {% for s in related_services %}
                  <a href="/{{ CURRENT_LANG }}/services/{{ s.slug }}/" class="service-card glass">
                    {% if s.featured_image %}
                      <img src="{{ s.featured_image }}" alt="{{ s.title }}">
                    {% endif %}
                    <h3>{{ s.title }}</h3>
                    <p>{{ s.short_description }}</p>
                  </a>
                {% endfor %}
              </div>
            </section>
          {% endif %}
        </aside>
      </div>
    </div>
  </section>

  <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è -->
  <section class="article-navigation">
    <div class="container">
      <div class="nav-links">
        <a href="/{{ CURRENT_LANG }}/news/" class="nav-link back">
          <span class="nav-icon">‚Üê</span>
          <span data-lang="en">All Tech News</span>
          <span data-lang="uk">–í—Å—ñ –Ω–æ–≤–∏–Ω–∏</span>
          <span data-lang="pl">Wszystkie wiadomo≈õci</span>
        </a>
        
  </section>

  <!-- –°–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ -->
  {% include 'includes/social_share.html' %}

</article>

<!-- –ö–æ–Ω—Ç–∞–∫—Ç —Ñ–æ—Ä–º–∞ -->
<section id="contact" class="contact">
  {% include "core/contact_form.html" %}
</section>

<script>
// Smooth scroll to contact function
function scrollToContact(articleTitle) {
  const contactSection = document.getElementById('contact');
  if (contactSection) {
    contactSection.scrollIntoView({ 
      behavior: 'smooth',
      block: 'start'
    });
    
    // Fill form with article info
    setTimeout(() => {
      const messageField = document.querySelector('#contact textarea, #contact input[name="message"]');
      if (messageField && articleTitle) {
        const currentLang = document.documentElement.lang || 'uk';
        const messages = {
          'uk': `–ü—Ä–∏–≤—ñ—Ç! –ü—Ä–æ—á–∏—Ç–∞–≤ —Å—Ç–∞—Ç—Ç—é "${articleTitle}" —ñ —Ö–æ—á—É –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—î—é –ø–æ–¥—ñ–±–Ω–∏—Ö —Ä—ñ—à–µ–Ω—å –¥–ª—è –º–æ–≥–æ –±—ñ–∑–Ω–µ—Å—É.`,
          'en': `Hi! I read the article "${articleTitle}" and want to know how you can help with automation of similar solutions for my business.`,
          'pl': `Cze≈õƒá! Przeczyta≈Çem artyku≈Ç "${articleTitle}" i chcƒô wiedzieƒá, jak mo≈ºecie pom√≥c z automatyzacjƒÖ podobnych rozwiƒÖza≈Ñ dla mojego biznesu.`
        };
        messageField.value = messages[currentLang] || messages['uk'];
        messageField.focus();
      }
    }, 1000);
  }
}
</script>
{% endblock %}