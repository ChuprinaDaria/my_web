{% load i18n %}
{% get_current_language as CURRENT_LANG %}

<!-- üéØ –ì–û–†–ò–ó–û–ù–¢–ê–õ–¨–ù–ê –ö–ê–†–¢–ö–ê –°–ï–†–í–Ü–°–£ (—è–∫ about-card) -->
<div class="service-card clickable" 
     data-href="/{{ CURRENT_LANG }}/services/{{ service.slug }}/"
     onclick="location.href='/{{ CURRENT_LANG }}/services/{{ service.slug }}/'">

  <!-- üñºÔ∏è IMAGE SECTION - –í–ò–ü–†–ê–í–õ–ï–ù–û! -->
  <div class="service-image">
    {% if service.icon %}
      <img src="{{ service.icon.url }}" 
           alt="{{ service.title|default:service.title_en }}" 
           class="service-img"
           loading="lazy">
    {% elif service.icon_url %}
      <img src="{{ service.icon_url }}" 
           alt="{{ service.title|default:service.title_en }}" 
           class="service-img"
           loading="lazy">
    {% else %}
      <div class="service-placeholder">
        <i data-lucide="cogs"></i>
      </div>
    {% endif %}
  </div>

  <!-- üìù TEXT CONTENT -->
  <div class="service-text">
    
    <!-- üè∑Ô∏è TAGS -->
    {% if service.tags_list %}
      <div class="service-tags">
        {% for tag in service.tags_list %}
          <span class="service-tag">
            {% if tag.icon %}{{ tag.icon }} {% endif %}{{ tag.name }}
          </span>
        {% endfor %}
      </div>
    {% endif %}

    <!-- üìÑ TITLE -->
    <h3>
      {% if service.title %}{{ service.title|safe }}
      {% elif CURRENT_LANG == 'uk' and service.title_uk %}{{ service.title_uk|safe }}
      {% elif CURRENT_LANG == 'pl' and service.title_pl %}{{ service.title_pl|safe }}
      {% else %}{{ service.title_en|safe }}{% endif %}
    </h3>

    <!-- üí≠ DESCRIPTION -->
    <p>
      {% with sd=service.short_description %}
        {% if sd %}{{ sd|safe|truncatewords:20 }}
        {% elif CURRENT_LANG == 'uk' and service.short_description_uk %}{{ service.short_description_uk|safe|truncatewords:20 }}
        {% elif CURRENT_LANG == 'pl' and service.short_description_pl %}{{ service.short_description_pl|safe|truncatewords:20 }}
        {% else %}{{ service.short_description_en|safe|truncatewords:20 }}{% endif %}
      {% endwith %}
    </p>

    <!-- üìä METRICS -->
    {% if service.related_articles_count or service.related_projects_count or service.priority %}
      <div class="service-metrics">
        {% if service.priority and service.priority > 3 %}
          <span class="metric">üî• HIGH PRIORITY</span>
        {% endif %}
        {% if service.related_projects_count %}
          <span class="metric">üöÄ {{ service.related_projects_count }} projects</span>
        {% endif %}
        {% if service.related_articles_count %}
          <span class="metric">üì∞ {{ service.related_articles_count }} articles</span>
        {% endif %}
      </div>
    {% endif %}

    <!-- üéØ CTA BUTTON - —è–∫ —É –ø—Ä–æ—î–∫—Ç–∞—Ö -->
    <div class="service-cta">
      <button class="cta-button" 
              data-service-title="{% if service.title %}{{ service.title|escapejs }}{% elif CURRENT_LANG == 'uk' and service.title_uk %}{{ service.title_uk|escapejs }}{% elif CURRENT_LANG == 'pl' and service.title_pl %}{{ service.title_pl|escapejs }}{% else %}{{ service.title_en|escapejs }}{% endif %}"
              onclick="event.stopPropagation(); scrollToContact(this.dataset.serviceTitle);">
        <span class="cta-icon">üí¨</span>
        <span class="cta-text">
          {% if CURRENT_LANG == 'uk' %}–ó–∞–º–æ–≤–∏—Ç–∏ –ø–æ—Å–ª—É–≥—É
          {% elif CURRENT_LANG == 'pl' %}Zam√≥w us≈Çugƒô
          {% else %}Get This Service{% endif %}
        </span>
        <span class="cta-arrow">‚Üí</span>
      </button>
    </div>

  </div>
</div>