{% load i18n %}
{% get_current_language as CURRENT_LANG %}

<!-- ✅ MODERN FEATURED PROJECTS (WITH ACCORDION) -->
<div class="section-header">
  <h2>
    {% trans "Our Projects" %}
  </h2>
  {% if featured_subtitle %}
    <p>{{ featured_subtitle }}</p>
  {% endif %}
</div>

<!-- Сучасний список проєктів з акордеоном -->
<div class="projects-simple-list" role="list">
      {% for project in featured_projects|slice:":10" %}
        <article class="project-simple-item" role="article" data-project-id="{{ project.slug }}">

          <!-- Зображення проєкту -->
          <div class="project-media">
            {% if project.featured_image %}
              <img src="{{ project.featured_image.url }}"
                   alt="{% if CURRENT_LANG == 'uk' and project.title_uk %}{{ project.title_uk }}{% elif CURRENT_LANG == 'pl' and project.title_pl %}{{ project.title_pl }}{% else %}{{ project.title_en }}{% endif %}"
                   loading="lazy">
            {% else %}
              <div class="project-placeholder">
                <i data-lucide="image" class="placeholder-icon"></i>
              </div>
            {% endif %}
          </div>

          <!-- Основний контент -->
          <div class="project-content">
            <!-- Тригер акордеону -->
            <button class="project-trigger" type="button"
                    aria-expanded="false"
                    aria-controls="project-desc-{{ forloop.counter }}">
              
              <div class="project-header">
                <h3>
                  {% if CURRENT_LANG == 'uk' and project.title_uk %}{{ project.title_uk }}
                  {% elif CURRENT_LANG == 'pl' and project.title_pl %}{{ project.title_pl }}
                  {% else %}{{ project.title_en }}{% endif %}
                </h3>
                <i data-lucide="chevron-down" class="accordion-arrow" aria-hidden="true"></i>
              </div>
              
              <p>
                {% if CURRENT_LANG == 'uk' and project.short_description_uk %}{{ project.short_description_uk|safe|striptags|truncatewords:20 }}
                {% elif CURRENT_LANG == 'pl' and project.short_description_pl %}{{ project.short_description_pl|safe|striptags|truncatewords:20 }}
                {% else %}{{ project.short_description_en|safe|striptags|truncatewords:20 }}{% endif %}
              </p>
            </button>

            <!-- Розгорнутий опис (акордеон) -->
            <div id="project-desc-{{ forloop.counter }}" class="project-description-accordion" hidden>
              <div>
                {% if CURRENT_LANG == 'uk' and project.description_uk %}{{ project.description_uk|safe }}
                {% elif CURRENT_LANG == 'pl' and project.description_pl %}{{ project.description_pl|safe }}
                {% else %}{{ project.description_en|safe }}{% endif %}
              </div>
              
              <!-- Дії проєкту -->
              <div class="project-actions">
                <a class="btn-primary" href="/{{ CURRENT_LANG }}/projects/{{ project.slug }}/">
                  <i data-lucide="arrow-right"></i>
                  {% trans "View Details" %}
                </a>
                {% if project.project_url %}
                  <a class="btn-secondary" href="{{ project.project_url }}" target="_blank" rel="noopener">
                    <i data-lucide="external-link"></i>
                    {% trans "Demo" %}
                  </a>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Декоративний glow ефект -->
          <div class="project-glow-border" aria-hidden="true"></div>
        </article>
      {% empty %}
        <div class="empty-state">
          <i data-lucide="folder-x" class="empty-icon"></i>
          <p>{% trans "No featured projects available" %}</p>
        </div>
      {% endfor %}
</div>