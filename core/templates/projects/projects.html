{% extends "core/base.html" %}
{% load static i18n %}
{% get_current_language as CURRENT_LANG %}

{% block title %}{{ seo_title }}{% endblock %}
{% block meta_description %}{{ seo_description }}{% endblock %}
{% block og_title %}{{ seo_title }}{% endblock %}
{% block og_description %}{{ seo_description }}{% endblock %}
{% block og_image %}{% static 'images/projects-og.jpg' %}{% endblock %}

{% block extra_meta %}
  <link rel="canonical" href="https://lazysoft.dev/{{ CURRENT_LANG }}/projects/" />
  <link rel="alternate" href="https://lazysoft.dev/en/projects/" hreflang="en">
  <link rel="alternate" href="https://lazysoft.dev/uk/projects/" hreflang="uk">
  <link rel="alternate" href="https://lazysoft.dev/pl/projects/" hreflang="pl">
{% endblock %}

{% block content %}
<main class="projects-page">

  <!-- Hero Section - використовуємо існуючий hero стиль -->
  <section class="hero projects-hero">
    <div class="container">
      
     

      <!-- Hero Content - використовуємо існуючі класи -->
      <div class="hero-content">
        <h1>{{ overview_title|safe }}</h1>
        <p class="description">{{ overview_description|safe }}</p>
        
        <!-- Stats - використовуємо існуючий стиль -->
        <div class="projects-stats">
          <div class="stat-item">
            <span class="stat-number">{{ total_categories|default:"5" }}+</span>
            <span class="stat-label">{% trans "Categories" %}</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">{{ total_projects|default:"20" }}+</span>
            <span class="stat-label">{% trans "Projects" %}</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">100%</span>
            <span class="stat-label">{% trans "Success Rate" %}</span>
          </div>
        </div>

        <!-- CTA - використовуємо існуючий cta-primary -->
        <div class="hero-cta">
          <a href="#contact" class="cta-primary">
            <i data-lucide="rocket"></i>
            {% trans "Start Your Project" %}
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Projects Carousel -->
  {% if featured_projects_qs %}
    <section class="projects">
      <div class="container-reg">
        {% include 'includes/projects_carousel.html' with title=_('Featured Projects') projects=featured_projects_qs show_navigation=True carousel_id='featured-projects' %}
      </div>
    </section>
  {% endif %}

  <!-- Projects by Categories -->
  <section style="padding: var(--spacing-2xl) 0;">
    <div class="container">
      {% for category in categories %}
        <div style="margin-bottom: var(--spacing-2xl);">
          
          <!-- Category Header -->
          <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: var(--spacing-2xl); padding-bottom: var(--spacing-lg); border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
            <div>
              <!-- Використовуємо стандартний h2 -->
              <h2>{{ category.title|safe }}</h2>
              <p class="description" style="margin-top: var(--spacing-sm);">{{ category.description|safe }}</p>
            </div>
            
            <div style="text-align: right; flex-shrink: 0;">
              <span class="stat-number" style="display: block;">{{ category.projects|length }}</span>
              <span class="stat-label">{% trans "projects" %}</span>
            </div>
          </div>

          <!-- Projects Grid -->
          <div class="projects-grid">
            {% for project in category.projects %}
              {% include 'includes/project_card.html' with project=project %}
            {% endfor %}
          </div>

          <!-- Category CTA -->
          <div style="margin-top: var(--spacing-lg); display: flex; justify-content: center;">
            <div class="glass card" style="padding: var(--spacing-xl); text-align: center; max-width: 400px;">
              <p style="font-size: 1.1rem; margin-bottom: var(--spacing-lg);">
                {% trans "Need a similar solution?" %}
              </p>
              <button class="btn-secondary" onclick="scrollToContact('{{ category.title }}');">
                <i data-lucide="message-circle"></i>
                {% trans "Let's Discuss" %}
              </button>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </section>

  <!-- Final CTA -->
  <section style="padding: var(--spacing-2xl) 0;">
    <div class="container">
      <div class="glass card" style="max-width: 600px; margin: 0 auto; padding: var(--spacing-3xl); text-align: center;">
        <div style="font-size: 4rem; margin-bottom: var(--spacing-lg); color: var(--accent-green);">
          <i data-lucide="rocket"></i>
        </div>
        <!-- Використовуємо стандартний h2 -->
        <h2>{% trans "Ready to Start Your Project?" %}</h2>
        <p class="description">{% trans "From idea to automation - we make it happen" %}</p>
        
        <!-- Benefits -->
        <div style="display: flex; justify-content: center; gap: var(--spacing-xl); margin: var(--spacing-2xl) 0; flex-wrap: wrap;">
          <div style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 600;">
            <i data-lucide="zap" style="color: var(--accent-green);"></i>
            <span>{% trans "Fast Development" %}</span>
          </div>
          <div style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 600;">
            <i data-lucide="target" style="color: var(--accent-green);"></i>
            <span>{% trans "Custom Solutions" %}</span>
          </div>
          <div style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 600;">
            <i data-lucide="headphones" style="color: var(--accent-green);"></i>
            <span>{% trans "Ongoing Support" %}</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div style="display: flex; gap: var(--spacing-lg); justify-content: center; flex-wrap: wrap;">
          <a href="#contact" class="btn-primary">
            <i data-lucide="message-circle"></i>
            {% trans "Start Discussion" %}
          </a>
          
          <a href="/{{ CURRENT_LANG }}/services/" class="btn-secondary">
            <i data-lucide="grid-3x3"></i>
            {% trans "View Services" %}
          </a>
        </div>
      </div>
    </div>
  </section>

  {% include 'includes/social_share.html' %}

</main>

<!-- Contact Form -->
<section id="contact" class="contact">
  {% include "core/contact_form.html" %}
</section>

{% endblock %}

{% block extra_scripts %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ seo_title|escapejs }}",
  "description": "{{ seo_description|escapejs }}",
  "url": "https://lazysoft.dev/{{ CURRENT_LANG }}/projects/",
  "inLanguage": "{{ CURRENT_LANG }}",
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {% for category in categories %}
        {% for project in category.projects %}
        {
          "@type": "ListItem",
          "position": {{ forloop.parentloop.counter0|add:forloop.counter }},
          "url": "https://lazysoft.dev/{{ CURRENT_LANG }}/projects/{{ project.slug }}/",
          "name": "{{ project.title|escapejs }}"
        }{% if not forloop.last or not forloop.parentloop.last %},{% endif %}
        {% endfor %}
      {% endfor %}
    ]
  }
}
</script>

<script>
// Smooth scroll to contact function
function scrollToContact(projectInfo) {
  const contactSection = document.getElementById('contact');
  if (contactSection) {
    contactSection.scrollIntoView({ 
      behavior: 'smooth',
      block: 'start'
    });
    
    // Fill form with project info
    setTimeout(() => {
      const messageField = document.querySelector('#contact textarea, #contact input[name="message"]');
      if (messageField && projectInfo) {
        const currentLang = document.documentElement.lang || 'uk';
        const messages = {
          'uk': `Привіт! Мене зацікавили проекти з категорії "${projectInfo}". Хочу обговорити можливості співпраці.`,
          'en': `Hi! I'm interested in projects from "${projectInfo}" category. I'd like to discuss collaboration opportunities.`,
          'pl': `Cześć! Interesują mnie projekty z kategorii "${projectInfo}". Chciałbym omówić możliwości współpracy.`
        };
        messageField.value = messages[currentLang] || messages['uk'];
        messageField.focus();
      }
    }, 1000);
  }
}

// Initialize Lucide icons
document.addEventListener('DOMContentLoaded', function() {
  if (typeof lucide !== 'undefined') {
    lucide.createIcons();
  }
});
</script>
{% endblock %}