{% extends "core/base.html" %}
{% load static i18n %}
{% get_current_language as CURRENT_LANG %}

{% block title %}{{ seo_title }}{% endblock %}
{% block meta_description %}{{ seo_description }}{% endblock %}
{% block og_title %}{{ seo_title }}{% endblock %}
{% block og_description %}{{ seo_description }}{% endblock %}
{% block og_image %}{% static 'images/projects-og.jpg' %}{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/sections/projects.css' %}">
  <link rel="stylesheet" href="{% static 'css/components/projects_carousel.css' %}">
  <link rel="stylesheet" href="{% static 'css/components/project_card_home.css' %}">
{% endblock %}

{% block extra_meta %}
  <link rel="canonical" href="https://lazysoft.dev/{{ CURRENT_LANG }}/projects/" />
  <link rel="alternate" href="https://lazysoft.dev/en/projects/" hreflang="en">
  <link rel="alternate" href="https://lazysoft.dev/uk/projects/" hreflang="uk">
  <link rel="alternate" href="https://lazysoft.dev/pl/projects/" hreflang="pl">
{% endblock %}

{% block content %}
<main class="projects-page">

  <!-- Hero Section -->
  <section class="hero projects-hero">
    <div class="container">
      <div class="hero-content">
        <h1>{{ overview_title|safe }}</h1>
        <p class="description">{{ overview_description|safe }}</p>
        
        <!-- Stats -->
        <div class="projects-stats">
          <div class="stat-item">
            <span class="stat-number">{{ total_categories|default:"5" }}+</span>
            <span class="stat-label">{% trans "Categories" %}</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">{{ total_projects|default:"20" }}+</span>
            <span class="stat-label">{% trans "Projects" %}</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">100%</span>
            <span class="stat-label">{% trans "Success Rate" %}</span>
          </div>
        </div>

        <!-- CTA -->
        <div class="hero-cta">
          <a href="#contact" class="cta-primary">
            <i data-lucide="rocket"></i>
            {% trans "Start Your Project" %}
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Projects Carousel -->
  {% if featured_projects_qs %}
    <section class="featured-projects-section">
      <div class="container-reg">
        {% include 'includes/projects_carousel.html' with title=_('Featured Projects') projects=featured_projects_qs show_navigation=True carousel_id='featured-projects' %}
      </div>
    </section>
  {% endif %}

  <!-- Projects by Categories -->
  <section class="projects-categories-section">
    <div class="container">
      {% for category in categories %}
        <div class="category-item">
          
          <!-- Category Header -->
          <div class="category-header">
            <div>
              <h2 class="section-title category-title">{{ category.title|safe }}</h2>
              <p class="description category-description">{{ category.description|safe }}</p>
            </div>
            
            <div class="category-stats">
              <span class="stat-number">{{ category.projects|length }}</span>
              <span class="stat-label">{% trans "projects" %}</span>
            </div>
          </div>

          <!-- Projects Grid -->
          <div class="projects-grid">
            {% for project in category.projects %}
              {% include 'includes/project_card.html' with project=project %}
            {% endfor %}
          </div>

          <!-- Category CTA -->
          {% include 'includes/category_cta.html' with category=category %}
        </div>
      {% endfor %}
    </div>
  </section>

  <!-- Final CTA -->
  <section class="final-cta-section">
    <div class="container">
      <div class="glass card final-cta-card">
        <div class="final-cta-icon">
          <i data-lucide="rocket"></i>
        </div>
        <h2 class="final-cta-title">{% trans "Ready to Start Your Project?" %}</h2>
        <p class="description final-cta-description">{% trans "From idea to automation - we make it happen" %}</p>
        
        <!-- Benefits -->
        <div class="final-cta-benefits">
          <div class="benefit-item">
            <i data-lucide="zap" class="benefit-icon"></i>
            <span>{% trans "Fast Development" %}</span>
          </div>
          <div class="benefit-item">
            <i data-lucide="target" class="benefit-icon"></i>
            <span>{% trans "Custom Solutions" %}</span>
          </div>
          <div class="benefit-item">
            <i data-lucide="headphones" class="benefit-icon"></i>
            <span>{% trans "Ongoing Support" %}</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="final-cta-actions">
          <a href="#contact" class="btn-primary">
            <i data-lucide="message-circle"></i>
            {% trans "Start Discussion" %}
          </a>
          
          <a href="/{{ CURRENT_LANG }}/services/" class="btn-secondary">
            <i data-lucide="grid-3x3"></i>
            {% trans "View Services" %}
          </a>
        </div>
      </div>
    </div>
  </section>

  {% include 'includes/social_share.html' %}

</main>

<!-- Contact Form -->
<section id="contact" class="contact">
  {% include "core/contact_form.html" %}
</section>

{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/projects_carousel.js' %}"></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ seo_title|escapejs }}",
  "description": "{{ seo_description|escapejs }}",
  "url": "https://lazysoft.dev/{{ CURRENT_LANG }}/projects/",
  "inLanguage": "{{ CURRENT_LANG }}",
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {% for category in categories %}
        {% for project in category.projects %}
        {
          "@type": "ListItem",
          "position": {{ forloop.parentloop.counter0|add:forloop.counter }},
          "url": "https://lazysoft.dev/{{ CURRENT_LANG }}/projects/{{ project.slug }}/",
          "name": "{{ project.title|escapejs }}"
        }{% if not forloop.last or not forloop.parentloop.last %},{% endif %}
        {% endfor %}
      {% endfor %}
    ]
  }
}
</script>

<script>
// Smooth scroll to contact function
function scrollToContact(projectInfo) {
  const contactSection = document.getElementById('contact');
  if (contactSection) {
    contactSection.scrollIntoView({ 
      behavior: 'smooth',
      block: 'start'
    });
    
    // Fill form with project info
    setTimeout(() => {
      const messageField = document.querySelector('#contact textarea, #contact input[name="message"]');
      if (messageField && projectInfo) {
        const currentLang = document.documentElement.lang || 'uk';
        const messages = {
          'uk': `Привіт! Мене зацікавили проекти з категорії "${projectInfo}". Хочу обговорити можливості співпраці.`,
          'en': `Hi! I'm interested in projects from "${projectInfo}" category. I'd like to discuss collaboration opportunities.`,
          'pl': `Cześć! Interesują mnie projekty z kategorii "${projectInfo}". Chciałbym omówić możliwości współpracy.`
        };
        messageField.value = messages[currentLang] || messages['uk'];
        messageField.focus();
      }
    }, 1000);
  }
}

// Initialize Lucide icons
document.addEventListener('DOMContentLoaded', function() {
  if (typeof lucide !== 'undefined') {
    lucide.createIcons();
  }
});
</script>
{% endblock %}