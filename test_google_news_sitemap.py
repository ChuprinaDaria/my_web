#!/usr/bin/env python3
"""
–¢–µ—Å—Ç Google News Sitemap
"""
import os
import sys
import django

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'lazysoft.settings')
django.setup()

from django.test import Client
from django.urls import reverse

def test_google_news_sitemap():
    """–¢–µ—Å—Ç—É—î Google News sitemap"""
    print("üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Google News Sitemap...")
    
    client = Client()
    
    # –¢–µ—Å—Ç—É—î–º–æ –æ—Å–Ω–æ–≤–Ω–∏–π sitemap
    print("\n1. –¢–µ—Å—Ç—É—î–º–æ –æ—Å–Ω–æ–≤–Ω–∏–π sitemap...")
    response = client.get('/sitemap.xml')
    print(f"   –°—Ç–∞—Ç—É—Å: {response.status_code}")
    if response.status_code == 200:
        print("   ‚úÖ –û—Å–Ω–æ–≤–Ω–∏–π sitemap –ø—Ä–∞—Ü—é—î")
    else:
        print("   ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –∑ –æ—Å–Ω–æ–≤–Ω–∏–º sitemap")
        print(f"   –í—ñ–¥–ø–æ–≤—ñ–¥—å: {response.content.decode()[:200]}...")
    
    # –¢–µ—Å—Ç—É—î–º–æ Google News sitemaps –¥–ª—è –∫–æ–∂–Ω–æ—ó –º–æ–≤–∏
    languages = ['uk', 'pl', 'en']
    for lang in languages:
        print(f"\n2.{languages.index(lang)+1}. –¢–µ—Å—Ç—É—î–º–æ Google News sitemap ({lang})...")
        response = client.get(f'/news-sitemap-{lang}.xml')
        print(f"   –°—Ç–∞—Ç—É—Å: {response.status_code}")
        if response.status_code == 200:
            print(f"   ‚úÖ Google News sitemap ({lang}) –ø—Ä–∞—Ü—é—î")
            content = response.content.decode()
            print(f"   –†–æ–∑–º—ñ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: {len(content)} —Å–∏–º–≤–æ–ª—ñ–≤")
            
            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á–æ–≤–∏—Ö —Ç–µ–≥—ñ–≤
            if 'xmlns:news="http://www.google.com/schemas/sitemap-news/0.9"' in content:
                print("   ‚úÖ Google News namespace –ø—Ä–∏—Å—É—Ç–Ω—ñ–π")
            else:
                print("   ‚ùå Google News namespace –≤—ñ–¥—Å—É—Ç–Ω—ñ–π")
                
            if '<news:news>' in content:
                print("   ‚úÖ news:news —Ç–µ–≥–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ")
            else:
                print("   ‚ùå news:news —Ç–µ–≥–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ")
                
            if '<news:publication>' in content:
                print("   ‚úÖ news:publication —Ç–µ–≥–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ")
            else:
                print("   ‚ùå news:publication —Ç–µ–≥–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ")
                
            if f'<news:language>{lang}</news:language>' in content:
                print(f"   ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –º–æ–≤–∞ ({lang}) –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")
            else:
                print(f"   ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –º–æ–≤–∞ –≤ sitemap")
                
            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ UTC —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏
            if 'T' in content and 'Z' in content:
                print("   ‚úÖ UTC —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π")
            else:
                print("   ‚ùå UTC —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π")
                
            print(f"\n   –ü—Ä–µ–≤'—é –∫–æ–Ω—Ç–µ–Ω—Ç—É:")
            print("   " + content[:500] + "...")
            
        else:
            print(f"   ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –∑ Google News sitemap ({lang})")
            print(f"   –í—ñ–¥–ø–æ–≤—ñ–¥—å: {response.content.decode()[:200]}...")
    
    # –¢–µ—Å—Ç—É—î–º–æ news sitemap
    print("\n3. –¢–µ—Å—Ç—É—î–º–æ news sitemap...")
    response = client.get('/sitemap-news.xml')
    print(f"   –°—Ç–∞—Ç—É—Å: {response.status_code}")
    if response.status_code == 200:
        print("   ‚úÖ News sitemap –ø—Ä–∞—Ü—é—î")
    else:
        print("   ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –∑ news sitemap")
        print(f"   –í—ñ–¥–ø–æ–≤—ñ–¥—å: {response.content.decode()[:200]}...")

if __name__ == "__main__":
    test_google_news_sitemap()
